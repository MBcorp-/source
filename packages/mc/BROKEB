This is still a work in progress -- lots of MSDOS constants need working around.

